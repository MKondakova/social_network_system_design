# System design для социальной сети

Этот репозиторий создается в рамках курса по System design.

## Формализация требований

Описание функциональности, предоставленное бизнесом:

> - публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
> - оценка и комментарии постов других путешественников;
> - подписка на других путешественников, чтобы следить за их активностью;
> - поиск популярных мест для путешествий и просмотр постов с этих мест в виде ТОПа мест по странам и городам;
> - общение с другими путешественниками в личных сообщениях;
> - просмотр ленты других путешественников

К функциональным требованиям добавим:

- существует общая лента постов путешественников, на которых он подписан
- можно посмотреть историю своих лайков
- в сообщениях можно обмениваться только текстом и изображениями
- в ленте показывается 20 постов, потом она догружается

Нефункциональные требования:

- Аудитория:
  - пользователи по всему миру
  - DAO около 1_000_000
  - пользователи будут делать посты в путешествиях, то есть пачками, 4 поста в день во время путешествия. Путешествовать будут 6 дней в месяц. В остальное время будут открывать ленту раз в день и ставить около 15 лайков и 5 комментариев. Вести переписку час в день по сообщению в минуту c 5ю собеседниками
- Сезонность: так как аудитория по всему миру, сезонности не будет, все путешествуют в разное время
- Хранить данные нужно всегда, потеря их критична
- Лимиты и ограничения:
  - у пользователя будет не больше 1000 подписок
  - для пользователя возможна публикация не более 100 постов в день
- Временные ограничения:
  - пост должен публиковаться за 30 секунд
  - сообщения должны доходить за 0.5 секунды
  - лента должна загружаться не дольше 5 секунд
- Доступность приложения: приложение может быть недоступно не более суток в год

## Оценка нагрузки

### RPS

RPS_read_lenta = 1_000_000 * 3 (сколько загрузок ленты) / 86400 = 35

RPS_read_messages = 1_000_000 * 5 (сколько открывалось диалогов)  / 86400 = 58

RPS_read = 35+58 = 93

RPS_write_post = 1_000_000 * 4 * (6/30.5) / 86400 = 9

RPS_write_messages = 1_000_000 * 60 (сообщений в день) / 86400 =  695

RPS_write_like = 1_000_000 * 15 / 86400 = 174

RPS_write_comments = 1_000_000 * 5 / 86400 =  58

RPS_write = 58 + 174 + 695 + 9 = 936

### Трафик

T_read_lenta = 35 * 20 постов в ленте * (500 kB картинка + (500B текст + 8B геолокация + идентификатор пользователя 8B + 4B лайки + 10 * 100B комментарии)) = 350mB картинок + 1mB

T_read_messages = 58 * 100B = 5kB

T_write_post = 9 * (500 kB картинка + (500B текст + 8B геолокация + идентификатор пользователя 8B)) = 4,5 mB картинок + 4,6 kB

T_write_messages =  695 * 100B = 70kB

T_write_like = 174 * 4B идентификатор пользователя = 700B

T_write_comments =  58 * (100B текст + 4B идентификатор пользователя) = 6 kB

### 